//@version=5
strategy("Advanced Bollinger Bands Strategy", 
         overlay=true, 
         margin_long=100, 
         margin_short=100)

// Input parameters
length = input.int(20, minval=1, title="Bollinger Band Length")
mult = input.float(2.0, minval=0.001, maxval=50, title="Bollinger Band Multiplier")
src = input(close, title="Source")

// Calculate Bollinger Bands
basis = ta.sma(src, length)
dev = mult * ta.stdev(src, length)
upper = basis + dev
lower = basis - dev

// Plot Bollinger Bands
plot(basis, color=color.blue, title="Basis")
p1 = plot(upper, color=color.red, title="Upper Band")
p2 = plot(lower, color=color.green, title="Lower Band")
fill(p1, p2, color=color.new(color.blue, 90))

// Strategy Entry and Exit Conditions
longCondition = ta.crossover(close, lower)
shortCondition = ta.crossover(upper, close)

// Long Entry
if (longCondition)
    strategy.entry("Long", strategy.long)

// Short Entry
if (shortCondition)
    strategy.entry("Short", strategy.short)

// Take Profit and Stop Loss Conditions
// Configurable inputs for TP and SL
tpMultiplier = input.float(2.0, title="Take Profit Multiplier")
slMultiplier = input.float(1.0, title="Stop Loss Multiplier")

longTakeProfit = basis + (dev * tpMultiplier)
longStopLoss = basis - (dev * slMultiplier)

shortTakeProfit = basis - (dev * tpMultiplier)
shortStopLoss = basis + (dev * slMultiplier)

// Long Exit Conditions
strategy.exit("Long Exit", "Long", 
              limit=longTakeProfit, 
              stop=longStopLoss)

// Short Exit Conditions
strategy.exit("Short Exit", "Short", 
              limit=shortTakeProfit, 
              stop=shortStopLoss)
